<!DOCTYPE html>
<html>
  <head>
    <title>Titan</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
  </head>

  <body>
   <%# <% flash.each do |key, value| %> 
    <%# <div id="flash-message" class="alert alert-<%= key %>
      <%# <%= value %> 
      <%# <button id="close-flash">OK</button> %>
    <%# </div> %>
  <%# <% end %> 

    <%= yield %>

     <script>
    document.addEventListener('DOMContentLoaded', function() {
      var flashMessage = document.getElementById('flash-message');

      // Vérifier si la popup existe
      if (flashMessage) {
        // Ajouter un bouton "OK"
        var closeButton = document.createElement('button');
        closeButton.textContent = 'OK';
        closeButton.addEventListener('click', function() {
          flashMessage.style.display = 'none';
        });
        flashMessage.appendChild(closeButton);

        // Afficher la popup
        flashMessage.style.display = 'block';
      }
    });
  </script>
  <%# <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Vérifier si l'utilisateur est connecté en vérifiant la présence d'un élément spécifique dans la page
      var loggedInElement = document.getElementById('logged-in-indicator');

      // Si l'utilisateur est déconnecté et essaie d'accéder à une page protégée, rediriger vers la page de connexion
      if (!loggedInElement && window.location.pathname !== '/admin/users') {
        window.location.href = '/admin/users';
      }
    });
  </script> %>
  </body>
</html>
